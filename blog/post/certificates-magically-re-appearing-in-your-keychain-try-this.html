<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Blog | Tapadoo </title><meta name="next-head-count" content="3"/><link rel="preload" href="/Tapadoo-site/_next/static/css/232a30425848af9b.css" as="style"/><link rel="stylesheet" href="/Tapadoo-site/_next/static/css/232a30425848af9b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/Tapadoo-site/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/Tapadoo-site/_next/static/chunks/webpack-461e027a94344cdf.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/framework-715a76d8b0695da7.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/main-baed5792d4d394cf.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/pages/_app-c68c249bf95195e7.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/996-f765e51b6a74c60f.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/402-722b6745331d1e2f.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/pages/blog/post/%5Bslug%5D-85a3e3efd6d46107.js" defer=""></script><script src="/Tapadoo-site/_next/static/jG6HNdE2cjk8s5SucJ8mC/_buildManifest.js" defer=""></script><script src="/Tapadoo-site/_next/static/jG6HNdE2cjk8s5SucJ8mC/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="bg-base-100 shadow-sm"><header class="navbar max-w-7xl mx-auto "><div class="navbar-start"><a href="/Tapadoo-site"><img src="/Tapadoo-site/_next/static/media/tapadoo-large-logo.b51a8a63.png" alt="Tapadoo logo" class="w-full max-w-[120px] cursor-pointer"/></a></div><div class="navbar-end md:hidden flex"><div class="dropdown dropdown-left"><label tabindex="0" class="btn btn-ghost lg:hidden"><button><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6Z" fill="currentColor"></path><path d="M2 12.0322C2 11.4799 2.44772 11.0322 3 11.0322H21C21.5523 11.0322 22 11.4799 22 12.0322C22 12.5845 21.5523 13.0322 21 13.0322H3C2.44772 13.0322 2 12.5845 2 12.0322Z" fill="currentColor"></path><path d="M3 17.0645C2.44772 17.0645 2 17.5122 2 18.0645C2 18.6167 2.44772 19.0645 3 19.0645H21C21.5523 19.0645 22 18.6167 22 18.0645C22 17.5122 21.5523 17.0645 21 17.0645H3Z" fill="currentColor"></path></svg></button></label><ul class="menu menu-compact dropdown-content mt-3 p-2 shadow bg-base-100 rounded-box w-52"><li><a class="font-semibold  " href="/Tapadoo-site/tapadoo/about">Tapadoo</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/about">Who are you?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/localization">Where are you based?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/work">Who do you work with?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/careers">Are you hiring?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/contact">Get in touch</a></li><li><a class="font-semibold  " href="/Tapadoo-site/apps/requisites">Apps</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/requisites">Do I need an app?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/costs">How much does an app cost?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/success-cases">Case Studies</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/process">Process</a></li><li><a class="font-semibold  " href="/Tapadoo-site/blog/1">Blog</a></li></ul></div></div><div class="navbar-end hidden md:flex"><ul class="menu menu-horizontal p-0"><li><a class="  " href="/Tapadoo-site/tapadoo/about">Tapadoo</a></li><li><a class="  " href="/Tapadoo-site/apps/requisites">Apps</a></li><li><a class="  " href="/Tapadoo-site/blog/1">Blog</a></li></ul></div></header></div><main class="min-h-[70vh] relative"> <div class="p-4 max-w-5xl mx-auto mt-[5vh]"><figure><img src="https://cdn-bhcgp.nitrocdn.com/lQsUIlYWTGkhjqgYKmLJkHSBczAwGDPM/assets/static/optimized/rev-f8d7f54/wp-content/uploads/2019/04/tapadoo_background_linkedin.png.webp" alt="Certificates Magically Re-appearing in your keychain? Try thisTapadoo blog" class="rounded-xl max-w-[90vw] mx-auto w-full"/></figure><section class="mb-10"><h1 class="app-title my-8">Certificates Magically Re-appearing in your keychain? Try this</h1><div class="categories"><p class="my-4 text-lg font-medium">Tags : </p><p class="p-2 text-xs px-4 bg-neutral rounded-lg inline-block text-gray-100 font-semibold cursor-pointer">development</p><p class="p-2 text-xs px-4 bg-neutral rounded-lg inline-block text-gray-100 font-semibold cursor-pointer">iphone</p><p class="p-2 text-xs px-4 bg-neutral rounded-lg inline-block text-gray-100 font-semibold cursor-pointer">iphonedev</p></div><div class="w-full bg-neutral h-[1px] my-8 opacity-60"></div><p class="blog-text text-justify">We&#x27;ve had this ongoing issue on our Continuous Integration server which had us scratching our heads. It went like this:</p>
<ol>
<li class="list-disc ml-5 my-1">We create a certificate for our CI &quot;Developer&quot;</li>
<li class="list-disc ml-5 my-1">We add him to the provisioning certificate</li>
<li class="list-disc ml-5 my-1">The build is fine</li>
<li class="list-disc ml-5 my-1">Some time later, we update the provisioning profile, and install this - We remove the old certificate from the key chain</li>
<li class="list-disc ml-5 my-1">Each subsequent build, the old certificate magically re-appears in the key chain, and the code-signing fails as there are multiple matched certificates in the keychain</li>
</ol>
<p class="blog-text text-justify">If you&#x27;ve seen this; here&#x27;s what I think is happening, and here&#x27;s how you work around it.</p>
<p class="blog-text text-justify">The certificate is embedded in the provisioning certificate. During the code signing process, a check is made to see if this is in the keychain; if it isn&#x27;t, the code signing process adds it to the keychain. Because the keychain has a matching private key, the certificate is now valid again, but cannot be used, as you now have 2 keys with the same identity in the keychain.</p>
<p class="blog-text text-justify">We tried deleting the older certificate time and time again, but the build process always brought it back. So frustrating. Also; there&#x27;s radars about this (<a class="text-primary " href="http://openradar.appspot.com/9173280">example</a>, and there&#x27;s <a class="text-primary " href="http://stackoverflow.com/questions/5932522/codesign-error-certificate-identity-appearing-twice">questions on StackOverflow about it</a>.</p>
<p class="blog-text text-justify">But here&#x27;s a little tip that helps; Note the certificate is put back into the keychain, but codesign will only work with a certificate where the private key is also in the keychain. The problem arises when the re-inserted certificate has its private key in the keychain.</p>
<p class="blog-text text-justify">So, next time this happens</p>
<ol>
<li class="list-disc ml-5 my-1">Locate the older, duplicate certificate</li>
<li class="list-disc ml-5 my-1">Expand it</li>
<li class="list-disc ml-5 my-1">Delete it&#x27;s private key</li>
</ol>
<p class="blog-text text-justify">Now, even if you remove the certificate also, and even if your build re-instates the certificate, the private key will not be in the keychain, and so this older, duplicate certificate will not be used to sign your binary.</p>
<p class="blog-text text-justify">Yay. Go us.</p></section></div> </main><footer class="p-10 bg-[#eeeeee90] text-[#A09893] "><div class="app-container footer"><div><img src="/Tapadoo-site/_next/static/media/tapadoo-large-logo.b51a8a63.png" alt="Tapadoo logo" class="w-full max-w-[120px] cursor-pointer grayscale"/><div class="my-4"><p>26-28 Strand Street Great, Dublin 1 </p><a href="mailto:enquiries@tapadoo.com">enquiries@tapadoo.com</a></div><a href="tel:3531123456">+353 1 123456</a></div><div><span class="footer-title">Links</span><a class="link link-hover" href="/Tapadoo-site/tapadoo/contact">Privacy Policy</a><a class="link link-hover" href="/Tapadoo-site/tapadoo/contact">Support</a></div><div><span class="footer-title">Company</span><a class="link link-hover" href="/Tapadoo-site/tapadoo/about">About us</a><a class="link link-hover" href="/Tapadoo-site/tapadoo/careers">Careers</a><a class="link link-hover" href="/Tapadoo-site/apps/costs">Pricing</a><a class="link link-hover" href="/Tapadoo-site/blog/1">Blog</a></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Certificates Magically Re-appearing in your keychain? Try this","date":"2012-06-29","content":"\nWe've had this ongoing issue on our Continuous Integration server which had us scratching our heads. It went like this:\n\n1. We create a certificate for our CI \"Developer\"\n2. We add him to the provisioning certificate\n3. The build is fine\n4. Some time later, we update the provisioning profile, and install this - We remove the old certificate from the key chain\n5. Each subsequent build, the old certificate magically re-appears in the key chain, and the code-signing fails as there are multiple matched certificates in the keychain\n\nIf you've seen this; here's what I think is happening, and here's how you work around it.\n\nThe certificate is embedded in the provisioning certificate. During the code signing process, a check is made to see if this is in the keychain; if it isn't, the code signing process adds it to the keychain. Because the keychain has a matching private key, the certificate is now valid again, but cannot be used, as you now have 2 keys with the same identity in the keychain.\n\nWe tried deleting the older certificate time and time again, but the build process always brought it back. So frustrating. Also; there's radars about this ([example](http://openradar.appspot.com/9173280), and there's [questions on StackOverflow about it](http://stackoverflow.com/questions/5932522/codesign-error-certificate-identity-appearing-twice).\n\nBut here's a little tip that helps; Note the certificate is put back into the keychain, but codesign will only work with a certificate where the private key is also in the keychain. The problem arises when the re-inserted certificate has its private key in the keychain.\n\nSo, next time this happens\n\n1. Locate the older, duplicate certificate\n2. Expand it\n3. Delete it's private key\n\nNow, even if you remove the certificate also, and even if your build re-instates the certificate, the private key will not be in the keychain, and so this older, duplicate certificate will not be used to sign your binary.\n\nYay. Go us.\n","postImage":"https://cdn-bhcgp.nitrocdn.com/lQsUIlYWTGkhjqgYKmLJkHSBczAwGDPM/assets/static/optimized/rev-f8d7f54/wp-content/uploads/2019/04/tapadoo_background_linkedin.png.webp","categories":["development","iphone","iphonedev"]}},"__N_SSG":true},"page":"/blog/post/[slug]","query":{"slug":"certificates-magically-re-appearing-in-your-keychain-try-this"},"buildId":"jG6HNdE2cjk8s5SucJ8mC","assetPrefix":"/Tapadoo-site","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>