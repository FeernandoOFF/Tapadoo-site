<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Blog | Tapadoo </title><meta name="next-head-count" content="3"/><link rel="preload" href="/Tapadoo-site/_next/static/css/dcff2b350ca0f8bc.css" as="style"/><link rel="stylesheet" href="/Tapadoo-site/_next/static/css/dcff2b350ca0f8bc.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/Tapadoo-site/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/Tapadoo-site/_next/static/chunks/webpack-461e027a94344cdf.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/framework-715a76d8b0695da7.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/main-baed5792d4d394cf.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/pages/_app-c68c249bf95195e7.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/996-f765e51b6a74c60f.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/402-722b6745331d1e2f.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/pages/blog/post/%5Bslug%5D-a7214b4e547bd820.js" defer=""></script><script src="/Tapadoo-site/_next/static/Q-zTeVmP8HXvAaul7cq2b/_buildManifest.js" defer=""></script><script src="/Tapadoo-site/_next/static/Q-zTeVmP8HXvAaul7cq2b/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="bg-base-100 shadow-sm"><header class="navbar max-w-7xl mx-auto "><div class="navbar-start"><a href="/Tapadoo-site"><img src="/Tapadoo-site/_next/static/media/tapadoo-large-logo.b51a8a63.png" alt="Tapadoo logo" class="w-full max-w-[120px] cursor-pointer"/></a></div><div class="navbar-end md:hidden flex"><div class="dropdown dropdown-left"><label tabindex="0" class="btn btn-ghost lg:hidden"><button><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6Z" fill="currentColor"></path><path d="M2 12.0322C2 11.4799 2.44772 11.0322 3 11.0322H21C21.5523 11.0322 22 11.4799 22 12.0322C22 12.5845 21.5523 13.0322 21 13.0322H3C2.44772 13.0322 2 12.5845 2 12.0322Z" fill="currentColor"></path><path d="M3 17.0645C2.44772 17.0645 2 17.5122 2 18.0645C2 18.6167 2.44772 19.0645 3 19.0645H21C21.5523 19.0645 22 18.6167 22 18.0645C22 17.5122 21.5523 17.0645 21 17.0645H3Z" fill="currentColor"></path></svg></button></label><ul class="menu menu-compact dropdown-content mt-3 p-2 shadow bg-base-100 rounded-box w-52"><li><a class="font-semibold  " href="/Tapadoo-site/tapadoo/about">Tapadoo</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/about">Who are you?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/localization">Where are you based?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/work">Who do you work with?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/careers">Are you hiring?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/contact">Get in touch</a></li><li><a class="font-semibold  " href="/Tapadoo-site/apps/requisites">Apps</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/requisites">Do I need an app?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/costs">How much does an app cost?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/success-cases">Case Studies</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/process">Process</a></li><li><a class="font-semibold  " href="/Tapadoo-site/blog/1">Blog</a></li></ul></div></div><div class="navbar-end hidden md:flex"><ul class="menu menu-horizontal p-0"><li><a class="  " href="/Tapadoo-site/tapadoo/about">Tapadoo</a></li><li><a class="  " href="/Tapadoo-site/apps/requisites">Apps</a></li><li><a class="  " href="/Tapadoo-site/blog/1">Blog</a></li></ul></div></header></div><main class="min-h-[70vh]"> <div class="p-4 max-w-5xl mx-auto mt-[5vh]"><figure><img src="https://cdn-bhcgp.nitrocdn.com/lQsUIlYWTGkhjqgYKmLJkHSBczAwGDPM/assets/static/optimized/rev-f8d7f54/wp-content/uploads/2019/04/tapadoo_background_linkedin.png.webp" alt="Sharing NSUserDefaults between your app and a Today Extension on iOS 8Tapadoo blog" class="rounded-xl max-w-[90vw] mx-auto w-full"/></figure><section class="mb-10"><h1 class="app-title my-8">Sharing NSUserDefaults between your app and a Today Extension on iOS 8</h1><div class="categories"><p class="my-4 text-lg font-medium">Tags : </p><p class="p-2 text-xs px-4 bg-neutral rounded-lg inline-block text-gray-100 font-semibold cursor-pointer">development</p></div><div class="w-full bg-neutral h-[1px] my-8 opacity-60"></div><p class="blog-text text-justify">Today extensions are the new iOS 8 feature that allows you to put widgets on the Notification Screen. This post will show you how you can share data through <code>NSUserDefaults</code>.</p>
<p class="blog-text text-justify">This is a simple, but probably common use case. Your main app has a set of &quot;things&quot; it displays, and the user may want to display some of these &quot;things&quot; on the Notification screen, so the app allows you to specify this. It&#x27;s not unusual to store this meta-data in <code>NSUserDefaults</code>.</p>
<p class="blog-text text-justify">At WWDC we&#x27;ve been told that Today Extensions run in a separate process, so have their own sandbox. By default, there&#x27;s no mechanism for sharing. Of course the engineers at Apple have considered this, so here are the details.</p>
<p class="blog-text text-justify">Sharing of data is achieved through a new concept called &quot;App Groups&quot;. App Groups are allowed to share some data, including files, but it is worth noting that file access needs to be marshalled to avoid concurrent writes and so forth. This can be achieved through <code>NSFileCoordination</code>, but CoreData and <code>NSUserDefaults</code> handle this out of the box.</p>
<p class="blog-text text-justify">To read from the same set of <code>NSUserDefaults</code>:</p>
<ol>
<li class="list-disc ml-5 my-1">In your main app, select your project in the project navigator.</li>
<li class="list-disc ml-5 my-1">Select your main app target and choose the capabilities tab.</li>
<li class="list-disc ml-5 my-1">Switch on App Groups (this will communicate with the developer portal, as it is generating a set of entitlements, and relevant App Id and so forth).</li>
<li class="list-disc ml-5 my-1">Create a new container. According to the help, it must start with &quot;group.&quot;, so give it a name like &quot;group.com.mycompany.myapp&quot;.</li>
<li class="list-disc ml-5 my-1">Select your Today Extension target and repeat this process of switching on app groups. Don&#x27;t create a new one, rather select this newly created group to signify that the Today Extension is a member of the group.</li>
<li class="list-disc ml-5 my-1">When reading or writing your <code>NSUserDefaults</code> in either your app or your extension, don&#x27;t access <code>[NSUserDefaults standardUserDefaults]</code>. Instead use <code>[[NSUserDefaults alloc] initWithSuiteName:@&quot;group.com.mycompany.myapp&quot;]</code> Note: You must use the name of your group in as the suite name.</li>
</ol>
<p class="blog-text text-justify">Now both your extension and your app will be accessing the same set of <code>NSUserDefaults</code>, so can share data.</p>
<p class="blog-text text-justify">Other tips: If you&#x27;ve abstracted reading/writing of <code>NSUserDefaults</code> to a class, you can extract this into a Framework that both your app and Extension link to. Building Frameworks for Cocoa Touch is now pretty simple in XCode 6/iOS 8.</p>
<p class="blog-text text-justify">Don&#x27;t forget this still involves two separate processes. For example, my original abstracted class used a singleton pattern and cached some of the data in memory. This of course won&#x27;t work; two processes means two completely separate singletons which were blissfullly unaware when a process updated the file. I just had to alter properties to read from NSUserDefaults every time, rather than using an in-memory copy.</p></section></div> </main><footer class="p-10 bg-[#eeeeee90] text-[#A09893] "><div class="app-container footer"><div><img src="/Tapadoo-site/_next/static/media/tapadoo-large-logo.b51a8a63.png" alt="Tapadoo logo" class="w-full max-w-[120px] cursor-pointer grayscale"/><div class="my-4"><p>26-28 Strand Street Great, Dublin 1 </p><a href="mailto:enquiries@tapadoo.com">enquiries@tapadoo.com</a></div><a href="tel:3531123456">+353 1 123456</a></div><div><span class="footer-title">Links</span><a class="link link-hover" href="/Tapadoo-site/tapadoo/contact">Privacy Policy</a><a class="link link-hover" href="/Tapadoo-site/tapadoo/contact">Support</a></div><div><span class="footer-title">Company</span><a class="link link-hover" href="/Tapadoo-site/tapadoo/about">About us</a><a class="link link-hover" href="/Tapadoo-site/tapadoo/careers">Careers</a><a class="link link-hover" href="/Tapadoo-site/apps/costs">Pricing</a><a class="link link-hover" href="/Tapadoo-site/blog/1">Blog</a></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Sharing NSUserDefaults between your app and a Today Extension on iOS 8","date":"2014-06-12","content":"\nToday extensions are the new iOS 8 feature that allows you to put widgets on the Notification Screen. This post will show you how you can share data through `NSUserDefaults`.\n\nThis is a simple, but probably common use case. Your main app has a set of \"things\" it displays, and the user may want to display some of these \"things\" on the Notification screen, so the app allows you to specify this. It's not unusual to store this meta-data in `NSUserDefaults`.\n\nAt WWDC we've been told that Today Extensions run in a separate process, so have their own sandbox. By default, there's no mechanism for sharing. Of course the engineers at Apple have considered this, so here are the details.\n\nSharing of data is achieved through a new concept called \"App Groups\". App Groups are allowed to share some data, including files, but it is worth noting that file access needs to be marshalled to avoid concurrent writes and so forth. This can be achieved through `NSFileCoordination`, but CoreData and `NSUserDefaults` handle this out of the box.\n\nTo read from the same set of `NSUserDefaults`:\n\n1. In your main app, select your project in the project navigator.\n2. Select your main app target and choose the capabilities tab.\n3. Switch on App Groups (this will communicate with the developer portal, as it is generating a set of entitlements, and relevant App Id and so forth).\n4. Create a new container. According to the help, it must start with \"group.\", so give it a name like \"group.com.mycompany.myapp\".\n5. Select your Today Extension target and repeat this process of switching on app groups. Don't create a new one, rather select this newly created group to signify that the Today Extension is a member of the group.\n6. When reading or writing your `NSUserDefaults` in either your app or your extension, don't access `[NSUserDefaults standardUserDefaults]`. Instead use `[[NSUserDefaults alloc] initWithSuiteName:@\"group.com.mycompany.myapp\"]` Note: You must use the name of your group in as the suite name.\n\nNow both your extension and your app will be accessing the same set of `NSUserDefaults`, so can share data.\n\nOther tips: If you've abstracted reading/writing of `NSUserDefaults` to a class, you can extract this into a Framework that both your app and Extension link to. Building Frameworks for Cocoa Touch is now pretty simple in XCode 6/iOS 8.\n\nDon't forget this still involves two separate processes. For example, my original abstracted class used a singleton pattern and cached some of the data in memory. This of course won't work; two processes means two completely separate singletons which were blissfullly unaware when a process updated the file. I just had to alter properties to read from NSUserDefaults every time, rather than using an in-memory copy.\n","categories":["development"]}},"__N_SSG":true},"page":"/blog/post/[slug]","query":{"slug":"sharing-nsuserdefaults-between-your-app-and-a-today-extension-on-ios-8"},"buildId":"Q-zTeVmP8HXvAaul7cq2b","assetPrefix":"/Tapadoo-site","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>