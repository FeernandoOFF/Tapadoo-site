<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Blog | Tapadoo </title><meta name="next-head-count" content="3"/><link rel="preload" href="/Tapadoo-site/_next/static/css/a0d44aa37cf6330f.css" as="style"/><link rel="stylesheet" href="/Tapadoo-site/_next/static/css/a0d44aa37cf6330f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/Tapadoo-site/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/Tapadoo-site/_next/static/chunks/webpack-461e027a94344cdf.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/framework-715a76d8b0695da7.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/main-baed5792d4d394cf.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/pages/_app-c68c249bf95195e7.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/996-f765e51b6a74c60f.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/402-722b6745331d1e2f.js" defer=""></script><script src="/Tapadoo-site/_next/static/chunks/pages/blog/post/%5Bslug%5D-720d9d7269f2dce5.js" defer=""></script><script src="/Tapadoo-site/_next/static/n9cWt2i2X49CTP55VazPm/_buildManifest.js" defer=""></script><script src="/Tapadoo-site/_next/static/n9cWt2i2X49CTP55VazPm/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="bg-base-100 shadow-sm z-50"><header class="navbar max-w-7xl mx-auto "><div class="navbar-start"><a href="/Tapadoo-site"><img src="/Tapadoo-site/_next/static/media/tapadoo-large-logo.b51a8a63.png" alt="Tapadoo logo" class="w-full max-w-[120px] cursor-pointer"/></a></div><div class="navbar-end md:hidden flex"><div class="dropdown dropdown-left"><label tabindex="0" class="btn btn-ghost lg:hidden"><button><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6Z" fill="currentColor"></path><path d="M2 12.0322C2 11.4799 2.44772 11.0322 3 11.0322H21C21.5523 11.0322 22 11.4799 22 12.0322C22 12.5845 21.5523 13.0322 21 13.0322H3C2.44772 13.0322 2 12.5845 2 12.0322Z" fill="currentColor"></path><path d="M3 17.0645C2.44772 17.0645 2 17.5122 2 18.0645C2 18.6167 2.44772 19.0645 3 19.0645H21C21.5523 19.0645 22 18.6167 22 18.0645C22 17.5122 21.5523 17.0645 21 17.0645H3Z" fill="currentColor"></path></svg></button></label><ul class="menu menu-compact dropdown-content mt-3 p-2 shadow bg-base-100 rounded-box w-52 z-50"><li><a class="font-semibold  " href="/Tapadoo-site/tapadoo/about">Tapadoo</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/about">Who are you?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/localization">Where are you based?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/work">Who do you work with?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/careers">Are you hiring?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/tapadoo/contact">Get in touch</a></li><li><a class="font-semibold  " href="/Tapadoo-site/apps/requisites">Apps</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/requisites">Do I need an app?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/costs">How much does an app cost?</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/success-cases">Case Studies</a><a class=" border my-2  border-transparent" href="/Tapadoo-site/apps/process">Process</a></li><li><a class="font-semibold  " href="/Tapadoo-site/blog/1">Blog</a></li></ul></div></div><div class="navbar-end hidden md:flex"><ul class="menu menu-horizontal p-0"><li><a class="  " href="/Tapadoo-site/tapadoo/about">Tapadoo</a></li><li><a class="  " href="/Tapadoo-site/apps/requisites">Apps</a></li><li><a class="  " href="/Tapadoo-site/blog/1">Blog</a></li></ul></div></header></div><main class="min-h-[70vh] relative"> <div class="p-4 max-w-5xl mx-auto mt-[5vh]"><figure><img src="https://cdn-bhcgp.nitrocdn.com/lQsUIlYWTGkhjqgYKmLJkHSBczAwGDPM/assets/static/optimized/rev-f8d7f54/wp-content/uploads/2019/04/tapadoo_background_linkedin.png.webp" alt="A simple credits screen with Core AnimationTapadoo blog" class="rounded-xl max-w-[90vw] mx-auto w-full"/></figure><section class="mb-10"><h1 class="app-title my-8">A simple credits screen with Core Animation</h1><div class="categories"><p class="my-4 text-lg font-medium">Tags : </p><p class="p-2 text-xs px-4 bg-neutral rounded-lg inline-block text-gray-100 font-semibold cursor-pointer">iphone</p><p class="p-2 text-xs px-4 bg-neutral rounded-lg inline-block text-gray-100 font-semibold cursor-pointer">iphonedev</p></div><div class="w-full bg-neutral h-[1px] my-8 opacity-60"></div><p class="blog-text text-justify">Whilst working on my latest iPhone project (not yet announced), I wanted to do up a useful credits screen. This project had more than just myself involved and I wanted to ensure everyone got a mention.</p>
<p class="blog-text text-justify">I was also conscious of the exposure my apps were getting through <a class="text-primary " href="http://apps.ie">apps.ie</a>, so wanted to do something that would link back too. So..I&#x27;ve put together a simple credits screen which uses Core Animation to show the individual credits. This post explains the code, and how it works. There&#x27;s a gotcha or two in there as well.</p>
<p class="blog-text text-justify">**How does it look?**<strong>Data Structure</strong> For the purposes of a credit, I wanted to be able to store</p>
<ul>
<li class="list-disc ml-5 my-1">The person&#x27;s name</li>
<li class="list-disc ml-5 my-1">What they did</li>
<li class="list-disc ml-5 my-1">Their twitter id</li>
<li class="list-disc ml-5 my-1">The web site</li>
<li class="list-disc ml-5 my-1">An avatar</li>
</ul>
<p class="blog-text text-justify">That&#x27;s easy - I wrote a class called AppCredit, which is a pure data structure. It doesn&#x27;t do anything beyond store the above details.</p>
<p class="blog-text text-justify"><strong>The View On The Data</strong> So, how would I visualise the data structure ? I had an idea of how this should look, so I created a CreditsView (in fact a view controller XIB), which layed out the information in a way that I thought looked nice:</p>
<p class="blog-text text-justify"><img src="/Tapadoo-site/images/asinglecredit.png" class="my-3 mx-auto"/></p>
<p class="blog-text text-justify">I wanted the twitter name and the web address to be tappable, to take you away to the relevant website. To achieve this, I overlayed the labels with custom buttons (essentially invisible buttons). I wired up their touchDown (so we can highlight), and their touchUpInside so we can actually open the relevant URL. We also followed good UI principals, in that we have an alert box pop up to warn that the user is about to leave the application. All of this is handled in the class CreditsView, along with the relevant nib file CreditView.xib</p>
<p class="blog-text text-justify"><strong>So where&#x27;s the animation?</strong> Well, I wanted that the entire view just described would fade in and out repeatedly, for each of the credits, so I wanted them showing as part of a larger container. This is the CreditsViewController. The CreditsViewController is the UIViewController for the overall credits page. It consists of</p>
<ol>
<li class="list-disc ml-5 my-1">A large label to show your application name</li>
<li class="list-disc ml-5 my-1">An area for the animated credits</li>
<li class="list-disc ml-5 my-1">A scroll area to store a brief description of your application</li>
<li class="list-disc ml-5 my-1">A &quot;bottom third&quot; with a description of apps.ie, along with another &quot;invisible button&quot; to take you there</li>
</ol>
<p class="blog-text text-justify">In addition, in the sample code, I added a toolbar, with a &quot;Done&quot; button to be able to dismiss the credits screen. For the purposes of this example, I worked of XCode&#x27;s standard &quot;Utility application&quot; template, and replaced the flipside view with my CreditsViewController. This meant adding some way to dismiss the credits view (In my actual app, it shows on a separate tab, so does not need a dismiss capability). The Done button is wired up the sample as the XCode sample, and should be obvious.</p>
<p class="blog-text text-justify"><strong>Supplying the data for the credits view</strong> I adopted a delegate approach to this. So theres a CreditsViewDelegate protocol, which we assign to the CreditsViewController. Once you implement this, and assign it to your CreditsViewController.delegate, it will ask the delegate for the necessary data as it needs it.</p>
<p class="blog-text text-justify"><strong>The actual animation</strong> The actual animation is quite simple. In a nutshell, it animates the first credit, when this is complete it animates the next one...and so on. When all have been animated, it just starts again. Here&#x27;s the detail</p>
<ol>
<li class="list-disc ml-5 my-1">When the CreditsViewController is loaded, it also loads up a CreditsView from the nib file</li>
<li class="list-disc ml-5 my-1">As it is about to appear, it asks its delegate for the necessary data, and fills in the labels</li>
<li class="list-disc ml-5 my-1">Once it has appeared, it starts to animate the CreditsView. It does this using the following code</li>
</ol>
<p class="blog-text text-justify">-(void) animateNextCredit
{
// Use animation to fade it in
CABasicAnimation *animation =
[CABasicAnimation animationWithKeyPath:@&quot;opacity&quot;];
animation.fromValue = [NSNumber numberWithFloat:0];
animation.toValue = [NSNumber numberWithFloat:1];
animation.repeatCount = 0;
animation.duration = 2;
animation.autoreverses = YES;
animation.delegate = self;
// Ok...Start showing our credits
[self getCredits];
if(credits != nil) {
AppCredit *credit = [credits objectAtIndex:currentCredit];
[creditsView setAppCredit:credit];
[self.view addSubview:creditsView.view];
}
currentCredit++;
if(currentCredit == [credits count]) {
currentCredit = 0;
}
[creditsView.view.layer
addAnimation:animation forKey:@&quot;credits&quot;];
}</p>
<p class="blog-text text-justify">Basically all that is happening here is we are telling the CreditsView (i.e. the small pane) to vary its opacity from 0 to 1 and back again, over 2 seconds. We set up self as the delegate to the animation, which means a method called animationDidStart will get called when we start, and animationDidStop when the animation completes. So..when animationDidStop gets called, we know we can move on to the next animation:</p>
<p class="blog-text text-justify">- (void)animationDidStop:(CAAnimation *)theAnimation
finished:(BOOL)flag
{
creditsView.view.layer.opacity = 0;
if(flag) {
// This means that animation ran to completion.
//  I.e. Was not interrupted
// e.g. by removeAllAnimations
// Cool - time to start another
[self animateNextCredit];
}
}</p>
<p class="blog-text text-justify"><strong>Gotchas</strong> There were a few problems I encountered when writing this code. Firstly, when the animation completed, there was an annoying flicker just before the second one started. This was caused because I had set the opacity to 1 in the CreditsView - Once the animation completed, the CreditsView was refreshed briefly back to full opacity. The fix was to set the opacity to 0. Once complete (i.e. faded out), if it were shown, it would be shown with full opacity, and therefore invisible. However, this led to a second problem. With the opacity set to 0, the CreditsView was essentially hidden, and so did not respond to taps. I couldn&#x27;t jump off to my twitter url, etc. I could see my view (because it was being animated from 0 to 1, but I could not interact with it).</p>
<p class="blog-text text-justify">This is caused by the fact that the actual state of the view and the displaying of it are independent; I could see it animating, but its opacity value was actually 0. When its opacity is 0 it is considered hidden, and therefore won&#x27;t respond to user input. To get around this, I experimented with very low values of opacity which would still respond to input, and found this to be around 0.02. So putting both of the above together: In animationDidStart, I set the opacity to 0.02. In animationDidEnd, I set the opacity to 0 (to avoid flicker). This all seems to work well. The next issue I found was another part of my app was slow after I ran my credits screen. I guessed that the animations were never cancelled. This was easy to fix, In my viewWillDisappear method, I just had to cancel my animations:</p>
<p class="blog-text text-justify">[creditsView.view.layer removeAllAnimations];</p>
<p class="blog-text text-justify">Note however that this will result in your animationDidStop method being called (which was where we started the next one, right?). But we can tell if we completed or were interrupted by the second parameter sent to animationDidStop, so this was easy to ensure we didn&#x27;t re-start. That&#x27;s what the if(flag) bit above is all about.</p>
<p class="blog-text text-justify"><strong>Improvements</strong> So how could I improve the code? There&#x27;s a couple of obvious points:</p>
<ol>
<li class="list-disc ml-5 my-1">In the credits view, I could extend UILabels and make them respond to input. This would negate the need for invisible UIButtons. Thanks to <a class="text-primary " href="http://www.steventroughtonsmith.com/">@stroughtonsmith</a> for that one. (Oh and for helping me with other gotchas).</li>
<li class="list-disc ml-5 my-1">I&#x27;ve done no internationalisation. Again, should be straightforward</li>
</ol>
<p class="blog-text text-justify">So that&#x27;s it. You can <a class="text-primary " href="http://files.me.com/dermdaly/6ndw0p">get the code</a> It looks better than the video on the simulator, and better still on the iPhone or iPod touch.</p>
<p class="blog-text text-justify">The code also uses a technique for doing a gradient background, as <a class="text-primary " href="http://cocoawithlove.com/2009/08/adding-shadow-effects-to-uitableview.html">outlined by Matt Gallagher</a> in his excellent &quot;Cocoa With Love&quot; blog. There&#x27;s two source files from that blog post in the code, unchanged.</p>
<p class="blog-text text-justify">If you&#x27;re an Irish Developer, you may consider using this as a basis for your upcoming projects, so it will link back to <a class="text-primary " href="http://apps.ie">apps.ie</a>. If you&#x27;ve come from elsewhere, welcome!</p>
<p class="blog-text text-justify">Feel free to use this code as you wish. If you&#x27;ve any comments, questions, or improvements, I&#x27;m happy to hear about them. Use the comment section below to leave feedback.</p>
<hr/>
<p class="blog-text text-justify">You&#x27;re reading the tapadoo blog. Did you know that as well as publishing our own applications, we offer iPhone development services and consultancy? If you have an idea, project or something you think we can help you with, please get in touch through <a class="text-primary " href="https://tapadoo.wpengine.com/contact/">our contact page</a>.</p></section></div> </main><footer class="p-10 bg-[#eeeeee90] text-[#A09893] "><div class="app-container footer"><div><img src="/Tapadoo-site/_next/static/media/tapadoo-large-logo.b51a8a63.png" alt="Tapadoo logo" class="w-full max-w-[120px] cursor-pointer grayscale"/><div class="my-4"><p>26-28 Strand Street Great, Dublin 1 </p><a href="mailto:enquiries@tapadoo.com">enquiries@tapadoo.com</a></div><a href="tel:3531123456">+353 1 123456</a></div><div><span class="footer-title">Links</span><a class="link link-hover" href="/Tapadoo-site/tapadoo/contact">Privacy Policy</a><a class="link link-hover" href="/Tapadoo-site/tapadoo/contact">Support</a></div><div><span class="footer-title">Company</span><a class="link link-hover" href="/Tapadoo-site/tapadoo/about">About us</a><a class="link link-hover" href="/Tapadoo-site/tapadoo/careers">Careers</a><a class="link link-hover" href="/Tapadoo-site/apps/costs">Pricing</a><a class="link link-hover" href="/Tapadoo-site/blog/1">Blog</a></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"A simple credits screen with Core Animation","date":"2009-10-01","content":"\nWhilst working on my latest iPhone project (not yet announced), I wanted to do up a useful credits screen. This project had more than just myself involved and I wanted to ensure everyone got a mention.\n\nI was also conscious of the exposure my apps were getting through [apps.ie](http://apps.ie), so wanted to do something that would link back too. So..I've put together a simple credits screen which uses Core Animation to show the individual credits. This post explains the code, and how it works. There's a gotcha or two in there as well.\n\n**How does it look?****Data Structure** For the purposes of a credit, I wanted to be able to store\n\n- The person's name\n- What they did\n- Their twitter id\n- The web site\n- An avatar\n\nThat's easy - I wrote a class called AppCredit, which is a pure data structure. It doesn't do anything beyond store the above details.\n\n**The View On The Data** So, how would I visualise the data structure ? I had an idea of how this should look, so I created a CreditsView (in fact a view controller XIB), which layed out the information in a way that I thought looked nice:\n\n![asinglecredit](images/asinglecredit.png \"asinglecredit\")\n\nI wanted the twitter name and the web address to be tappable, to take you away to the relevant website. To achieve this, I overlayed the labels with custom buttons (essentially invisible buttons). I wired up their touchDown (so we can highlight), and their touchUpInside so we can actually open the relevant URL. We also followed good UI principals, in that we have an alert box pop up to warn that the user is about to leave the application. All of this is handled in the class CreditsView, along with the relevant nib file CreditView.xib\n\n**So where's the animation?** Well, I wanted that the entire view just described would fade in and out repeatedly, for each of the credits, so I wanted them showing as part of a larger container. This is the CreditsViewController. The CreditsViewController is the UIViewController for the overall credits page. It consists of\n\n1. A large label to show your application name\n2. An area for the animated credits\n3. A scroll area to store a brief description of your application\n4. A \"bottom third\" with a description of apps.ie, along with another \"invisible button\" to take you there\n\nIn addition, in the sample code, I added a toolbar, with a \"Done\" button to be able to dismiss the credits screen. For the purposes of this example, I worked of XCode's standard \"Utility application\" template, and replaced the flipside view with my CreditsViewController. This meant adding some way to dismiss the credits view (In my actual app, it shows on a separate tab, so does not need a dismiss capability). The Done button is wired up the sample as the XCode sample, and should be obvious.\n\n**Supplying the data for the credits view** I adopted a delegate approach to this. So theres a CreditsViewDelegate protocol, which we assign to the CreditsViewController. Once you implement this, and assign it to your CreditsViewController.delegate, it will ask the delegate for the necessary data as it needs it.\n\n**The actual animation** The actual animation is quite simple. In a nutshell, it animates the first credit, when this is complete it animates the next one...and so on. When all have been animated, it just starts again. Here's the detail\n\n1. When the CreditsViewController is loaded, it also loads up a CreditsView from the nib file\n2. As it is about to appear, it asks its delegate for the necessary data, and fills in the labels\n3. Once it has appeared, it starts to animate the CreditsView. It does this using the following code\n\n\\-(void) animateNextCredit\n{\n  // Use animation to fade it in\n  CABasicAnimation \\*animation = \n      \\[CABasicAnimation animationWithKeyPath:@\"opacity\"\\];\n  animation.fromValue = \\[NSNumber numberWithFloat:0\\];\n  animation.toValue = \\[NSNumber numberWithFloat:1\\];\n  animation.repeatCount = 0;\n  animation.duration = 2;\n  animation.autoreverses = YES;\n  animation.delegate = self;\n  // Ok...Start showing our credits\n  \\[self getCredits\\];\n  if(credits != nil) {\n    AppCredit \\*credit = \\[credits objectAtIndex:currentCredit\\];\n    \\[creditsView setAppCredit:credit\\];\n    \\[self.view addSubview:creditsView.view\\];\n  }\n  currentCredit++;\n  if(currentCredit == \\[credits count\\]) {\n    currentCredit = 0;\n  }\n  \\[creditsView.view.layer \n       addAnimation:animation forKey:@\"credits\"\\];\n}\n\nBasically all that is happening here is we are telling the CreditsView (i.e. the small pane) to vary its opacity from 0 to 1 and back again, over 2 seconds. We set up self as the delegate to the animation, which means a method called animationDidStart will get called when we start, and animationDidStop when the animation completes. So..when animationDidStop gets called, we know we can move on to the next animation:\n\n\\- (void)animationDidStop:(CAAnimation \\*)theAnimation \n       finished:(BOOL)flag\n{\n  creditsView.view.layer.opacity = 0;\n  if(flag) {\n    // This means that animation ran to completion.\n    //  I.e. Was not interrupted\n    // e.g. by removeAllAnimations\n    // Cool - time to start another\n    \\[self animateNextCredit\\];\n  }\n}\n\n**Gotchas** There were a few problems I encountered when writing this code. Firstly, when the animation completed, there was an annoying flicker just before the second one started. This was caused because I had set the opacity to 1 in the CreditsView - Once the animation completed, the CreditsView was refreshed briefly back to full opacity. The fix was to set the opacity to 0. Once complete (i.e. faded out), if it were shown, it would be shown with full opacity, and therefore invisible. However, this led to a second problem. With the opacity set to 0, the CreditsView was essentially hidden, and so did not respond to taps. I couldn't jump off to my twitter url, etc. I could see my view (because it was being animated from 0 to 1, but I could not interact with it).\n\nThis is caused by the fact that the actual state of the view and the displaying of it are independent; I could see it animating, but its opacity value was actually 0. When its opacity is 0 it is considered hidden, and therefore won't respond to user input. To get around this, I experimented with very low values of opacity which would still respond to input, and found this to be around 0.02. So putting both of the above together: In animationDidStart, I set the opacity to 0.02. In animationDidEnd, I set the opacity to 0 (to avoid flicker). This all seems to work well. The next issue I found was another part of my app was slow after I ran my credits screen. I guessed that the animations were never cancelled. This was easy to fix, In my viewWillDisappear method, I just had to cancel my animations:\n\n\\[creditsView.view.layer removeAllAnimations\\];\n\nNote however that this will result in your animationDidStop method being called (which was where we started the next one, right?). But we can tell if we completed or were interrupted by the second parameter sent to animationDidStop, so this was easy to ensure we didn't re-start. That's what the if(flag) bit above is all about.\n\n**Improvements** So how could I improve the code? There's a couple of obvious points:\n\n1. In the credits view, I could extend UILabels and make them respond to input. This would negate the need for invisible UIButtons. Thanks to [@stroughtonsmith](http://www.steventroughtonsmith.com/) for that one. (Oh and for helping me with other gotchas).\n2. I've done no internationalisation. Again, should be straightforward\n\nSo that's it. You can [get the code](http://files.me.com/dermdaly/6ndw0p) It looks better than the video on the simulator, and better still on the iPhone or iPod touch.\n\nThe code also uses a technique for doing a gradient background, as [outlined by Matt Gallagher](http://cocoawithlove.com/2009/08/adding-shadow-effects-to-uitableview.html) in his excellent \"Cocoa With Love\" blog. There's two source files from that blog post in the code, unchanged.\n\nIf you're an Irish Developer, you may consider using this as a basis for your upcoming projects, so it will link back to [apps.ie](http://apps.ie). If you've come from elsewhere, welcome!\n\nFeel free to use this code as you wish. If you've any comments, questions, or improvements, I'm happy to hear about them. Use the comment section below to leave feedback.\n\n* * *\n\nYou're reading the tapadoo blog. Did you know that as well as publishing our own applications, we offer iPhone development services and consultancy? If you have an idea, project or something you think we can help you with, please get in touch through [our contact page](https://tapadoo.wpengine.com/contact/).\n","categories":["iphone","iphonedev"]}},"__N_SSG":true},"page":"/blog/post/[slug]","query":{"slug":"a-simple-credits-screen-with-core-animation"},"buildId":"n9cWt2i2X49CTP55VazPm","assetPrefix":"/Tapadoo-site","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>